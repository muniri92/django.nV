# Vunerability Report

#### Reviewer 1:
#### Reviewer 2:
#### Reviewer 3:
#### Date: April 26, 2016

### Reviewing nVisium Task Manager

# Vunerability 1 - Injection

### Exposure

We found that if we were to upload a photo and passed SQL commands as the file name, we were able to make acual SQL commands on the backend. This allows use to view and compromise infomation that would considered sensitive. For example we used the file name:

```
adminPW',(select password from auth_user where username='admin'),2);--
```

we were able to view the admin's hashed password.

### Repair

views.py contained the vulnerability. We were able to fix it with the following adjustments. 

Removed:
```
curs = connection.cursor()
curs.execute(
    "insert into taskManager_file ('name','path','project_id') values ('%s','%s',%s)" %
    (name, upload_path, project_id))
```

and replaced it with:
```
file = File(
name = name,
path = upload_path,
project = proj)
file.save()
```


# Vunerability 2 - Broken Auth

### Exposure

In the forms.py the admin had excluded fields as opposed to including only the fields that they wanted on the form. This made them forget to include, "is_superuser", and "is_staff". 
```
exclude = ['groups', 'user_permissions', 'last_login', 'date_joined', 'is_active']
```

### Repair

We changed the excludes list in forms.py to fields, and inputed the fields on the form. This allowed us to force the user to only input what we told them.
```
fields = ['username', 'first_name', 'last_name', 'password', 'email']
```

# Vunerability 3 - XSS

### Exposure

When logged in the template which displays the username uses the username field as a 'safe' object allowing users to put html or javascript as their username and have it run on the page. Such as popping up an alert window.
```
<span class="username"><i class="fa fa-user fa-fw"></i> {{ user.username | safe }}</span>
```

### Repair
Changed the template to not use the the safe option.
```
<span class="username"><i class="fa fa-user fa-fw"></i> {{ user.username }}</span>
```

# Vunerability 4 - Insecure Direct Object Reference

### Exposure
Any user not just admin can type up [site].com/admin and go to the management page of the website. There are a substainstal number of pages which do not require and special authorization to view so any user can see anything they want even if they are not connect to it.

### Repair
For all views which changes projects its been changed that those views require the user to be autheticated and a member of that project based off the project's user_assigned property.
```
if (request.user.is_authenticated() and
            request.user in Project.objects.get(pk=project_id).users_assigned.all()):
```


# Vunerability 5 - Security Misconfiguration

### Exposure
When a user types in a url that is not on the list fo urls, they can view all the urls on the site. This will not directly help hackers, but it can potentially lead to that.
```
DEBUG = True
TEMPLATE_DEBUG = True
```

### Repair
We set the DEBUG to False in the setting.py file. As well as setting the ALLOWEDHOSTS to include localhost.
```
DEBUG = False
TEMPLATE_DEBUG = False
ALLOWED_HOSTS = ['localhost']
```


# Vunerability 6 - Sensitive Data Exposure

### Exposure
The only hasher algorithm that the site is using is MD5PasswordHasher which is extremely insecure. 
```
PASSWORD_HASHERS = ['django.contrib.auth.hashers.MD5PasswordHasher']
```

### Repair
We added a different hasher that is more secure if password hashs are compromised.
```
PASSWORD_HASHERS = ['django.contrib.auth.hashers.BCryptPasswordHasher']
```



